# REForum Bug Tracker

本文档记录每次版本更新迭代中出现的 Bug 及其修复情况。

---

## 2025-12-03 - v1.7.2

### Bug #017: 移动端日历头部错位、Cookie 提示被遮挡、通知列表不同步

**严重程度**: 中等  
**影响范围**: 移动端与小屏幕用户  
**状态**: ✅ 已修复

**问题描述**:
- 首页日历在 768px / 480px 以下断点时，上一周 / 下一周 / 月份按钮 / 展开图标整组偏向右侧，图标未能保持居中，对齐错乱
- Cookie 同意横幅在手机端仍固定在页面底部，`接受` 按钮会被底部“工具集”浮动按钮覆盖，用户无法点击
- Inbox 通知只轮询未读数量，在移动端打开通知弹窗时并不会真正去请求通知列表，导致图标显示有未读但列表为空

**复现步骤**:
1. 在移动端或浏览器移动模式下打开首页，观察日历头部按钮位置，发现图标挤在右侧  
2. 触发 Cookie 提示（通过清除本地存储），在移动端看到横幅位于底部且 Accept 按钮被覆盖  
3. 使用登录账号让另一账号发帖触发通知，在手机端点击右上角通知按钮，看到徽章显示 1 条但列表为空

**根本原因**:
- 日历头部样式在小屏断点仍沿用桌面布局，`justify-content` 没有针对移动端调整，导致按钮组无法居中
- Cookie 提示组件只在桌面端考虑底部定位，移动端未覆写定位，导致与固定在底部的工具集按钮冲突
- `Inbox.jsx` 中 `fetchNotifications()` 仅在桌面端点击外部关闭的 effect 内调用，移动端 `showDropdown` 为 true 时没有拉取通知列表，只依靠未读数量轮询

**修复方案**:
- 在 `Home.css` 中为 `<768px` 与 `<480px` 的断点重新定义 `.calendar-header` 与 `.calendar-controls` 的对齐策略，使整组按钮在小屏幕上一行居中
- 在 `CookieConsent.css` 中为移动端设置 `top: 0; bottom: auto;`，让横幅在手机上固定到顶部，确保按钮不被遮挡
- 调整 `Inbox.jsx`：拆分桌面端“点击外部关闭”监听逻辑，并新增一个 effect 在 `showDropdown && isAuthenticated` 时统一调用 `fetchNotifications()`，保证移动端打开弹窗时会获取最新数据

**修复文件**:
- `frontend/src/pages/Home.css`
- `frontend/src/components/CookieConsent.css`
- `frontend/src/components/Inbox.jsx`

**测试验证**:
- ✅ 在 375px / 414px / 768px 等视口下，日历头部按钮保持居中且间距一致  
- ✅ 在手机端触发 Cookie 横幅，确认横幅显示在顶部且 Accept 按钮完全可见  
- ✅ 在移动端打开通知弹窗时立即获取最新通知，徽章数量与列表内容一致  
- ✅ 桌面端通知弹窗和 Cookie 横幅行为保持原状，无回归问题

---

## 2025-12-03 - v1.7.1

### Bug #015: 日历按日期筛选与帖子数量徽章在真实后端环境失效

**严重程度**: 中等  
**影响范围**: 所有使用首页日历视图的用户  
**状态**: ✅ 已修复

**问题描述**:
- 首页日历在接入真实后端数据后，点击某个日期并不会刷新帖子列表，始终停留在默认的时间段  
- 日历中每个日期右上角用于展示当天帖子数量的小徽章，只在本地 Mock 数据环境下能正确显示，在部署到真实服务器后始终为 0 或不显示  
- URL 虽然会在某些情况下包含 `?date=YYYY-MM-DD`，但这个参数没有真正驱动后端筛选  

**复现步骤**:
1. 在线上环境打开首页，切换到有日期视图的区域  
2. 点击任意一个有帖子的小圆点日期  
3. 观察右侧/下方帖子列表，发现内容没有切换到该日期发布的帖子  
4. 刷新页面或直接访问带 `?date=某一天` 的 URL，帖子列表依然不按日期过滤  
5. 对比本地使用 Mock 数据的环境，可以看到数量徽章正常、但点击后在真实后端下不会生效

**根本原因**:
- 帖子列表请求函数 `fetchPosts` 的触发条件只依赖 `page/sort/category`，没有监听 URL 中 `searchParams` 的变化，导致点击日历修改了 `?date=` 却不会重新发起请求  
- 虽然请求参数结构中预留了 `params.date`，但因为未走到带 `dateParam` 的分支，真实后端从未收到日期过滤条件  
- 日期分组与数量统计 `groupPostsByDate(allPosts)` 所依赖的 `allPosts` 只在特定请求成功后才更新，一旦真实环境请求失败或未触发，`postsByDate` 就为空

**修复方案**:
- 将 `debouncedFetchPosts` 的触发依赖从 `[pagination.page, sort, selectedCategory]` 扩展为 `[pagination.page, sort, selectedCategory, searchParams]`，确保点击日历修改 URL 后会重新请求  
- 在 `fetchPosts` 中读取 `const dateParam = searchParams.get('date')`，当存在时将其透传给后端：`params.date = dateParam`，由后端按日期执行过滤  
- 保留并强化 `fetchAllPostsForGrouping()` 调用逻辑，使其在成功请求后使用真实返回的帖子数组更新 `allPosts`，供日历数量徽章使用  
- 在有 `dateParam` 的情况下，热门模式对当前日期的帖子计算热门分数并排序，避免逻辑与默认视图不一致

**修复文件**:
- `frontend/src/pages/Home.jsx`

**测试验证**:
- ✅ 在真实后端环境下多次点击不同日期，帖子列表都会切换到对应日期的帖子  
- ✅ 验证日历上每个有帖子日期的右上角数量徽章与后端返回的数据一致  
- ✅ 使用 `?date=YYYY-MM-DD&sort=time`、`?date=YYYY-MM-DD&sort=hot` 直接访问页面时，列表内容与排序逻辑均正确  
- ✅ 在网络错误或后端异常时，日期分组安全回退，不会导致前端崩溃

---

### Bug #016: 移动端工具集中的头像菜单被底部按钮遮挡

**严重程度**: 低  
**影响范围**: 移动端与小屏幕已登录用户  
**状态**: ✅ 已修复

**问题描述**:
- 在移动端底部“工具集”弹窗中，头像按钮被放在工具列表的最下方
- 点击头像后弹出的用户菜单（个人资料 / 退出登录）默认向下展开
- 由于按钮本身位于底部，菜单会被底部工具集按钮或屏幕边缘遮挡，实际内容难以看清或无法完全点击

**复现步骤**:
1. 在手机或浏览器移动端模式下登录账户并打开任意页面  
2. 点击底部中间的“工具集”按钮，拉起工具列表  
3. 点击列表最底部的头像按钮，观察弹出的用户菜单位置  
4. 发现菜单内容被底部区域部分或全部遮住

**根本原因**:
- 用户菜单组件复用了桌面端的定位方式：`.user-dropdown` 统一以 `top: calc(100% + 0.5rem)` 自按钮下方展开  
- 在移动端动作面板中，头像按钮本身距离视口底部很近，导致“从下往下”展开的菜单超出可视区域，被底部按钮或屏幕边缘遮挡

**修复方案**:
- 保持桌面端行为不变，仅针对移动端工具集弹窗内部的头像菜单增加一个更高优先级的样式：  
  - 当头像按钮位于 `.header-actions-group-mobile .user-menu` 中时，将 `.user-dropdown` 的展开方向改为向上  
  - 使用 `top: auto; bottom: calc(100% + 0.5rem);` 使菜单从头像按钮上方弹出，避免被底部工具集按钮遮挡

**修复文件**:
- `frontend/src/components/Header.css`

**测试验证**:
- ✅ 在移动端工具集弹窗中点击头像按钮，菜单从按钮上方向上展开，所有选项均完全可见  
- ✅ 在桌面端右上角点击头像按钮，菜单仍然按原逻辑从按钮下方展开，行为未受影响  
- ✅ 各种移动端视口（含超小屏）均可完整看到“个人资料”和“退出登录”等菜单项

---

## 2025-12-03 - v1.7.0

### Bug #013: 移动端工具集按钮与工具列表排版混乱

**严重程度**: 中等  
**影响范围**: 移动端与小屏幕用户  
**状态**: ✅ 已修复

**问题描述**:
- 底部“工具集”按钮随页面整体滚动，无法始终停留在视口底部中央，使用体验割裂
- 打开工具集时弹窗可能覆盖按钮本身，关闭逻辑不统一（有时只能点遮罩/叉号）
- 工具集内各工具行（主题颜色、夜间模式、语言切换、通知、发布、用户菜单）文字与图标对齐不统一，有的图标停在中间，有的贴右侧，行间距不一致
- 移动端主题颜色选择和通知列表弹窗在部分分辨率下会被截断或超出屏幕

**复现步骤**:
1. 在手机或浏览器移动端模式下打开首页  
2. 向下滚动页面，观察底部“工具集”按钮是否会跟随整体内容一起下移  
3. 点击“工具集”按钮，观察弹出的工具列表是否覆盖按钮，以及能否通过再次点击按钮关闭  
4. 在工具集中依次查看各行按钮，留意文字与图标是否在一条竖线上、行间距是否均匀  
5. 分别点击主题颜色按钮与通知按钮，检查弹出的面板在小屏是否完整可见

**根本原因**:
- 工具集按钮嵌套在 Header 结构内部，仅靠普通定位，受父级布局与滚动影响，未真正相对视口固定  
- 工具集弹窗缺少明确的打开/关闭状态机，关闭只依赖部分交互路径，且遮罩层与按钮的层级关系不一致  
- 各工具行分别使用不同按钮/容器结构（`button` / `div`），缺少统一的 flex 布局规范和对齐规则  
- 移动端主题与通知面板使用的弹出样式与位置计算未专门为小屏视口裁剪，易产生遮挡或溢出

**修复方案**:
- 使用 `createPortal` 将底部“工具集”按钮从 Header 布局中抽离，挂载到 `document.body`，并通过 `position: fixed` + 居中定位保证始终位于视口底部中央  
- 新增 `isClosingActions` 状态，将工具集弹窗打开与关闭拆分为两个阶段，分别附加上滑/下滑动画，并统一通过按钮、遮罩和关闭图标调用同一关闭逻辑  
- 规范工具集内部的所有按钮：在移动端模式下统一为“左侧 label（`flex: 1`）、右侧 icon”的 flex 行布局，并统一行内/行间间距  
- 将移动端主题颜色选择与通知列表改为居中模态，使用固定定位和 body 滚动锁定，确保在小屏幕下也能完整显示

**修复文件**:
- `frontend/src/components/Header.jsx`
- `frontend/src/components/Header.css`
- `frontend/src/components/ThemeColorPicker.jsx`
- `frontend/src/components/ThemeColorPicker.css`
- `frontend/src/components/Inbox.jsx`
- `frontend/src/components/Inbox.css`
- `frontend/src/components/Sidebar.jsx`
- `frontend/src/components/Sidebar.css`

**测试验证**:
- ✅ 在多款移动设备与浏览器开发者工具中验证底部“工具集”按钮始终固定在视口底部中央  
- ✅ 重复点击“工具集”按钮、遮罩和右上角关闭图标，确认弹窗开启/关闭行为一致，且带有平滑动画  
- ✅ 检查工具集列表中所有行的文字列与图标列垂直对齐、间距统一  
- ✅ 在不同小屏分辨率下验证主题颜色选择器和通知列表完整可见，不再被裁切  

---

## 2025-12-03 - v1.6.1

### Bug #011: Header 搜索与时间模块在不同断点错位

**严重程度**: 中等  
**影响范围**: 桌面端与移动端用户  
**状态**: ✅ 已修复

**问题描述**:
- 搜索框仍位于中间，无法与 Logo 形成统一的左侧布局
- 新增日期/时间模块在 992px 以下断点无法保持居中，内容被挤压或换行
- Header actions 区域在 768px 以下断点换行混乱，按钮溢出或堆叠
- 日期的“日”字号与颜色过于突出，整体视觉失衡

**复现步骤**:
1. 打开首页，将浏览器宽度依次调整为 1200px、900px、700px、540px、420px
2. 观察搜索框、日期时间模块和右侧按钮的对齐情况
3. 在小屏幕上可看到元素错位、换行混乱或时间不再居中

**根本原因**:
- Header 的三列 Grid 未针对中等尺寸屏幕重新规划比例
- 日期/时间模块缺少统一约束，断点样式覆盖不完整
- Actions 区域在小屏幕时未强制换行与居中
- 日期“日”字号单独放大导致排版不协调

**修复方案**:
- 将搜索表单与 Logo 合并为左侧 Flex 容器 `.header-left`
- 新增独立的 `.header-center` 区块显示年月日与实时时钟，按语言格式化
- 重写 992/768/576/480px 断点，确保桌面端三列对齐，小屏按顺序堆叠
- 统一年月日字号和配色，使用等宽字体与轻量字重展示时间

**修复文件**:
- `frontend/src/components/Header.jsx`
- `frontend/src/components/Header.css`

**测试验证**:
- ✅ 在 1400/1200/992/768/576/480px 视口下验证搜索、时间与按钮排列
- ✅ 检查中/英/日语言下日期与时间格式正确
- ✅ 验证移动端按钮不重叠且可点击
- ✅ 确认时间每秒更新且始终居中

---

### Bug #012: 加载动画未随主题颜色同步且出现灰色方块残影

**严重程度**: 低  
**影响范围**: 所有用户（视觉体验）  
**状态**: ✅ 已修复

**问题描述**:
- 使用右上角“改变整体页面基调”功能后，重新刷新页面，加载动画仍然使用旧的蓝色基调
- 进度条环形外侧存在一层灰灰的方块感阴影，与新主题颜色不协调
- Intro 加载页的背景与实际页面背景色调不一致，显得割裂

**复现步骤**:
1. 在任意页面点击右上角主题颜色按钮，选择一个明显不同的颜色（如绿色或紫色）  
2. 刷新页面，观察加载动画的进度条与文字颜色  
3. 注意进度条周围出现灰色方块残影，且背景色与后续页面不一致

**根本原因**:
- Intro 加载页未包裹在 `ThemeProvider` 内，无法在初始化阶段读取最新主题变量  
- 加载进度条的发光阴影使用了固定的模糊样式，在部分环境下呈现为灰色矩形区域  
- 加载页背景写死为蓝色渐变，而非使用 `--background` 主题变量

**修复方案**:
- 将 `ThemeProvider` 挪到 `main.jsx`，在应用最外层包裹整个 `<App />`，包括加载动画  
- 调整 IntroLoader 的样式，使背景直接使用 `var(--background)`，进度条与文字使用 `--primary-color` 系列变量  
- 移除进度条的模糊阴影 `filter`，消除灰色方块残影

**修复文件**:
- `frontend/src/main.jsx`
- `frontend/src/App.jsx`
- `frontend/src/components/IntroLoader.jsx`
- `frontend/src/components/IntroLoader.css`

**测试验证**:
- ✅ 更换主题颜色后刷新页面，确认加载动画背景与主界面背景色调一致  
- ✅ 验证进度条环、百分比文字和 “LOADING” 文案颜色随主题变化  
- ✅ 确认进度条周围不再出现灰色方块或异常阴影

---

## 2025-12-03 - v1.5.8

### Bug #010: 错误提示信息未支持多语言

**严重程度**: 低  
**影响范围**: 所有非中文用户  
**状态**: ✅ 已修复

**问题描述**:
- 错误提示信息（如"加载失败"、"服务器错误"、"登录失败"等）硬编码为中文
- 非中文用户无法理解错误信息，影响用户体验
- 板块分类名称未支持多语言，始终显示中文名称
- 右侧标签容器提示文本未支持多语言

**复现步骤**:
1. 将语言切换为英文或日文
2. 触发任意错误（如网络错误、登录失败等）
3. 发现错误提示仍为中文
4. 查看板块分类，发现名称仍为中文

**根本原因**:
- 错误提示信息直接硬编码在组件中，未使用翻译系统
- 板块分类名称直接从数据库读取，未进行翻译处理
- 部分UI文本未添加到翻译系统中

**修复方案**:
- 在 LanguageContext 中添加完整的错误提示翻译键（`error.*`）
- 为板块分类名称创建翻译映射（`category.*`）
- 更新所有组件使用翻译函数显示错误信息和分类名称
- 添加 `getCategoryName()` 函数处理分类名称翻译
- 在组件层面实现错误消息的自动翻译检测

**修复文件**:
- `frontend/src/context/LanguageContext.jsx`
- `frontend/src/components/Sidebar.jsx`
- `frontend/src/components/RightSidebar.jsx`
- `frontend/src/pages/Home.jsx`
- `frontend/src/components/ErrorBoundary.jsx`
- `frontend/src/context/AuthContext.jsx`
- `frontend/src/components/LoginModal.jsx`
- `frontend/src/components/RegisterModal.jsx`
- `frontend/src/pages/CreatePost.jsx`
- `frontend/src/pages/PostDetail.jsx`
- `frontend/src/components/PostCard.jsx`

**测试验证**:
- ✅ 验证错误提示在三种语言下均能正确显示
- ✅ 验证板块分类名称在三种语言下均能正确显示
- ✅ 验证右侧标签容器提示文本在三种语言下均能正确显示
- ✅ 验证默认语言为英文
- ✅ 验证所有错误场景的提示信息都能正确翻译

---

## 2025-12-02 - v1.5.5

### Bug #008: 标签系统缺少物理效果和交互性

**严重程度**: 低  
**影响范围**: 所有用户（功能增强）  
**状态**: ✅ 已修复

**问题描述**:
- 标签系统使用简单的CSS动画，缺少真实的物理效果
- 标签无法拖拽，交互性不足
- 标签样式过于复杂，有色块和装饰，影响视觉效果
- 标签密度较低，占用空间较大
- 在响应式设备上可能影响其他内容的显示

**复现步骤**:
1. 打开REForum首页
2. 观察右侧标签区域
3. 发现标签只是简单的CSS动画，没有物理效果
4. 尝试拖拽标签，发现无法拖拽

**根本原因**:
- 使用纯CSS实现标签效果，无法实现真实的物理模拟
- 缺少物理引擎支持，无法实现碰撞、重力等效果
- 标签样式设计过于复杂

**修复方案**:
- 集成Matter.js物理引擎，实现真实的物理模拟
- 标签从容器上方掉落，具有重力、碰撞、摩擦等物理属性
- 实现标签拖拽功能，支持鼠标和触摸
- 简化标签样式，移除色块和装饰
- 减小标签尺寸，提高密度
- 优化响应式布局，确保不影响其他内容

**修复文件**:
- `frontend/src/components/RightSidebar.jsx`
- `frontend/src/components/RightSidebar.css`
- `frontend/src/App.css`
- `frontend/package.json`

**测试验证**:
- ✅ 验证标签从上方掉落效果
- ✅ 验证标签拖拽功能（鼠标和触摸）
- ✅ 验证标签碰撞效果
- ✅ 验证响应式设备上的显示
- ✅ 验证不影响其他内容布局

**相关提交**:
- Commit: `feat: Implement Matter.js physics engine for tags`

---

## 2025-12-02 - v1.5.4

### Bug #007: Header左右边距不对称（历史遗留问题）

**严重程度**: 低  
**影响范围**: 所有用户（视觉问题）  
**状态**: ✅ 已修复

**问题描述**:
- Header中左侧Logo与左侧边缘的距离和右侧按钮组合与右侧边缘的距离不一致
- 导致左右视觉不平衡，影响整体美观
- 这是一个历史遗留问题，多个版本更新迭代都未修复
- 在所有响应式断点下都存在此问题

**复现步骤**:
1. 打开REForum首页
2. 观察Header区域
3. 对比左侧Logo到左边缘的距离和右侧按钮组合到右边缘的距离
4. 发现左右距离不一致

**根本原因**:
- Grid布局中左右列虽然使用 `1fr`，但实际宽度可能因内容不同而不一致
- Logo和按钮组合可能有额外的margin或padding影响对齐
- 缺少确保左右严格对称的CSS规则

**修复方案**:
- 使用 `minmax(0, 1fr)` 替代 `1fr`，确保Grid布局中左右列严格等宽
- 移除Logo和按钮组合的额外margin和padding，设置为 `margin: 0; padding: 0;`
- 添加 `width: fit-content` 确保元素紧贴各自列的边缘
- 在所有响应式断点下保持左右对称

**修复文件**:
- `frontend/src/components/Header.css`

**测试验证**:
- ✅ 在所有响应式断点下验证左右边距对称
- ✅ 确认Logo和按钮组合都紧贴各自边缘
- ✅ 验证Grid布局中左右列严格等宽

**相关提交**:
- Commit: `fix: Header left-right margin asymmetry (historical issue)`

---

## 2025-12-02 - v1.5.3

### Bug #006: 响应式设备上Header按钮排版错乱

**严重程度**: 中等  
**影响范围**: 移动端和小屏幕用户  
**状态**: ✅ 已修复

**问题描述**:
- 将语言切换按钮从左下角移到右上角后，在响应式设备上出现排版错乱
- 多个按钮（主题切换、语言切换、Inbox、发布、登录/注册、用户头像）在小屏幕上挤在一起
- 按钮可能换行不当或溢出容器
- 在480px以下超小屏幕上布局问题更明显

**复现步骤**:
1. 在移动设备或浏览器开发者工具中打开REForum
2. 调整窗口宽度到不同断点（992px, 768px, 576px, 480px）
3. 观察右上角按钮区域的布局
4. 发现按钮可能重叠、换行不当或溢出

**根本原因**:
- Header actions区域在响应式断点下缺少足够的布局优化
- 按钮flex布局在小屏幕上没有正确处理换行和间距
- 480px以下断点缺少专门的处理
- 图标按钮和文字按钮的尺寸在小屏幕上不协调

**修复方案**:
- 优化992px、768px、576px断点的按钮布局
- 添加480px断点的专门处理
- 确保按钮在所有断点下都能正确换行和排列
- 调整按钮padding和font-size，确保在小屏幕上可读
- 优化语言菜单在小屏幕上的定位
- 确保图标按钮和文字按钮的尺寸协调

**修复文件**:
- `frontend/src/components/Header.css`

**测试验证**:
- ✅ 在992px、768px、576px、480px断点下测试按钮布局
- ✅ 验证按钮不会重叠或溢出
- ✅ 确认按钮换行合理，间距适当
- ✅ 验证语言菜单在小屏幕上正确定位

**相关提交**:
- Commit: `fix: Responsive header button layout issues on mobile devices`

---

## 2025-12-02 - v1.5.2

### Bug #005: 路由切换时标签位置重置

**严重程度**: 中等  
**影响范围**: 所有用户  
**状态**: ✅ 已修复

**问题描述**:
- 切换页面（如点击更新日志、问题修复等按钮）时，右侧标签的浮动位置和动画参数被重置
- 标签位置重新随机生成，导致视觉上的跳跃
- 动画参数（持续时间、延迟、方向）每次渲染都重新生成，导致动画不连贯

**复现步骤**:
1. 打开 REForum 首页，观察右侧标签的浮动位置
2. 点击"更新日志"或"问题修复"等按钮切换页面
3. 返回首页，发现标签位置和动画已经重置

**根本原因**:
- `useEffect` 依赖 `tags` 数组，每次组件重新渲染时都会重新生成位置
- 动画参数在每次渲染时都使用 `Math.random()` 重新生成
- 没有使用缓存机制来持久化位置和动画参数

**修复方案**:
- 使用 `useMemo` 生成标签签名，基于标签ID和postCount
- 使用 `useRef` 缓存位置数据和动画参数
- 仅在标签数据真正改变时（签名改变）才重新生成位置
- 动画参数存储在缓存中，避免每次渲染都重新生成

**修复文件**:
- `frontend/src/components/RightSidebar.jsx`

**测试验证**:
- ✅ 切换页面时标签位置保持不变
- ✅ 动画参数持久化，动画连贯
- ✅ 标签数据改变时正确重新生成位置

**相关提交**:
- Commit: `fix: Prevent tag position reset on route change`

---

## 2025-12-02 - v1.5.1

### Bug #001: 移动端通知下拉菜单显示不全

**严重程度**: 中等  
**影响范围**: 移动端用户  
**状态**: ✅ 已修复

**问题描述**:
- 在移动设备上，通知下拉菜单被截断或显示不完整
- 通知内容可能被底部导航栏遮挡
- 小屏幕上通知文字过大，导致显示不全

**复现步骤**:
1. 在移动设备上打开 REForum
2. 点击右上角的通知图标
3. 通知下拉菜单可能被截断或显示不完整

**根本原因**:
- 通知下拉菜单使用绝对定位，在移动端可能超出视口
- 缺少针对移动端的响应式样式
- 最大高度计算未考虑移动端底部导航栏

**修复方案**:
- 在移动端（768px 以下）使用固定定位（fixed positioning）
- 调整下拉菜单的位置和尺寸，确保完全显示在视口内
- 优化通知项的字体大小和内边距
- 改进最大高度计算，避免内容被遮挡

**修复文件**:
- `frontend/src/components/Inbox.css`

**测试验证**:
- ✅ 在移动设备上测试通知下拉菜单完全显示
- ✅ 验证不同屏幕尺寸下的显示效果
- ✅ 确认通知内容不被底部导航栏遮挡

**相关提交**:
- Commit: `fix: Mobile notification dropdown display issues`

---

## 2025-12-02 - v1.5.7

### Bug #005: 移动端通知列表仍然显示不全（残留问题）

**严重程度**: 中等  
**影响范围**: 移动端用户  
**状态**: ✅ 已修复

**问题描述**:
- 部分设备上通知下拉菜单虽然不再被遮挡，但长列表仍然无法完全滚动查看
- 顶部标题区域与列表共同挤占空间，导致可用高度不足

**复现步骤**:
1. 在移动设备上打开 REForum
2. 点击右上角通知图标，打开通知下拉菜单
3. 当通知数量较多时，最上方或最下方的通知会被截断，无法完整查看

**根本原因**:
- 下拉菜单 `max-height` 预留空间过大，导致实际可滚动区域不足
- 列表内部仍设置了 `max-height`，与外层高度限制叠加
- 头部区域未设置 `flex-shrink: 0`，在极端情况下会与列表互相挤压

**修复方案**:
- 调整移动端下拉菜单的 `max-height` 计算，减少多余的留白
- 移除列表内部的固定 `max-height`，改为依赖外层容器 + `flex: 1` 自动分配高度
- 为 `.inbox-header` 添加 `flex-shrink: 0`，保证标题区域不会被压缩

**修复文件**:
- `frontend/src/components/Inbox.css`

**测试验证**:
- ✅ 在多台不同分辨率手机上检查长列表通知滚动行为
- ✅ 确认顶部标题始终清晰可见
- ✅ 确认所有通知可以通过滚动完整查看

---

### Bug #006: 桌面端语言切换菜单难以点击

**严重程度**: 低  
**影响范围**: 桌面端用户  
**状态**: ✅ 已修复

**问题描述**:
- 语言切换图标悬浮后，菜单在鼠标稍微移出时就会立即关闭
- 用户很难将鼠标移动到菜单项上完成点击，导致语言无法正常切换

**复现步骤**:
1. 在桌面浏览器中打开 REForum
2. 将鼠标移动到右上角语言切换按钮上，弹出语言菜单
3. 尝试移动到菜单项上点击，菜单会在移动过程中自动收起

**根本原因**:
- 语言菜单的显示与隐藏依赖 `onMouseEnter` / `onMouseLeave` 事件
- 菜单与按钮之间存在细小空隙，鼠标经过空隙时会被视为“离开”

**修复方案**:
- 移除 `onMouseEnter` / `onMouseLeave` 控制逻辑，改为仅通过点击按钮开关菜单
- 使用全局点击监听，在点击菜单外部或选择语言后关闭菜单

**修复文件**:
- `frontend/src/components/Header.jsx`
- `frontend/src/components/Header.css`

**测试验证**:
- ✅ 在桌面端测试语言菜单可以稳定打开和点击
- ✅ 连续快速切换语言时菜单表现正常
- ✅ 点击页面其它区域时菜单能够正确关闭

---

## 2025-12-02 - v1.4.0

### Bug #002: 通知功能返回 500 错误

**严重程度**: 高  
**影响范围**: 所有用户  
**状态**: ✅ 已修复

**问题描述**:
- 访问通知 API 时返回 500 内部服务器错误
- 创建帖子后其他用户没有收到通知
- 前端控制台显示 "Failed to fetch unread count" 和 "Failed to fetch notifications"

**复现步骤**:
1. 登录账户
2. 查看右上角通知图标
3. 控制台显示 500 错误

**根本原因**:
- 数据库表 `notifications` 未创建
- 缺少表存在性检查
- 错误处理不够详细

**修复方案**:
- 添加数据库表存在性检查
- 改进错误处理和日志记录
- 创建详细的设置指南文档
- 更新诊断脚本检查 notifications 表

**修复文件**:
- `backend/models/Notification.js`
- `backend/controllers/notificationController.js`
- `backend/scripts/check-backend.js`
- `docs/NOTIFICATION_SETUP.md`

**测试验证**:
- ✅ 运行数据库迁移脚本
- ✅ 验证通知 API 正常工作
- ✅ 确认创建帖子时生成通知

**相关提交**:
- Commit: `fix: Improve notification error handling and add table existence check`

---

## 2025-12-01 - v1.3.2

### Bug #003: 头部导航按钮在特定宽度下不对齐

**严重程度**: 低  
**影响范围**: 中等屏幕用户  
**状态**: ✅ 已修复

**问题描述**:
- 在特定像素宽度下，头部导航按钮显示不对齐
- 右侧有大量留白

**修复方案**:
- 优化 Grid 布局，使用 `1fr auto 1fr` 确保左右对称
- 调整按钮对齐方式

**修复文件**:
- `frontend/src/components/Header.css`

---

## 2025-12-01 - v1.3.2

### Bug #004: 响应式布局问题

**严重程度**: 中等  
**影响范围**: 移动端用户  
**状态**: ✅ 已修复

**问题描述**:
- 帖子详情页标题在小屏幕上过大
- 首页和帖子卡片在移动端布局拥挤
- 错误状态提示在窄屏上显示不佳

**修复方案**:
- 添加 768px 和 480px 断点的响应式样式
- 优化字体大小、间距和布局

**修复文件**:
- `frontend/src/pages/PostDetail.css`
- `frontend/src/pages/Home.css`
- `frontend/src/components/PostCard.css`
- `frontend/src/App.css`

---

## Bug 分类统计

### 按严重程度
- **高**: 1 个
- **中等**: 3 个
- **低**: 2 个

### 按影响范围
- **所有用户**: 1 个
- **移动端用户**: 3 个
- **特定屏幕尺寸**: 1 个

### 按状态
- **已修复**: 6 个
- **待修复**: 0 个
- **已知问题**: 0 个

---

## 报告 Bug

如果发现新的 Bug，请：
1. 在 GitHub Issues 中创建问题报告
2. 提供详细的复现步骤
3. 包含错误截图和日志
4. 说明影响范围和严重程度

---

## 更新记录

- 2025-12-02: 创建 Bug Tracker 文档，记录 v1.4.0 和 v1.4.1 的 Bug
- 2025-12-02: 添加 v1.5.1 和 v1.5.2 的 Bug 修复记录

